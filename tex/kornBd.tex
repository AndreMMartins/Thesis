\section[Known Korn's Inequalities for SBD functions]{Known Korn's Inequalities for $SBD$ functions}
\label{sec:kornBulkSBD}
As we have seen in Chapter 2, Korn inequalities are very important for the development of the theory of elasticity, so in the last decade, many authors have been working to extend this result and improve Fracture Mechanics theory. 
Several function spaces derived from $BD$ were considered, which makes this problem particularly challenging since the gradient of this type of function might not even be a bounded measure, in fact, the problem of whether the analog of Korn’s inequality for $SBD$ functions $\Bu$ in $\Omega\backslash J_\Bu$ is true, is still open.  In order to overcome this issue, several research groups remove from $\Omega$ a small neighborhood $\omega$ of the jump set and prove the inequality in $\Omega\backslash\omega$. This was first established by Chambolle, Conti, and Francfort in 2014 \cite{kornBD1}. However since this topic has been so active the same group of authors have been able to improve the result several times \cite{kornBD2, kornBD3}. Simultaneously, Manuel Friedrich was able to also prove the similar Korn-Poincaré version of the results in a series of papers \cite{kornBD4, kornBD5}.

All the results are very similar, however, they can use different spaces or have different assumptions on the jump and different bounds on the size of $\omega$. The main goal of this chapter is to extend this type of inequality for plates, and we believe that the original technique used will work for most of the cases. To improve the readability of the results we chose to work with the Theorem 1.1 from \cite{kornBD3}:
    
\begin{theorem}\label{KornBDGeneralDomain}
    Let $n \in \mathbb{N}$ with $n \geq 2, p \in(1, \infty)$, and let $\Omega \subset \mathbb{R}^n$ be a bounded connected and open Lipschitz set. There exists $c=c(n, p, \Omega)>0$ such that, for any $\Bu \in$ $ S B D^p(\Omega)$, there is a set of finite perimeter $\omega \subset \Omega$ with $\mathcal{H}^{n-1}\left(\partial^* \omega\right) \leq c \mathcal{H}^{n-1}\left(J_u\right)$ and a skew-symmetric matrix A such that
    $$
    \int_{\Omega\backslash\omega}|\nabla \Bu-A|^p dx \leq c(n, p, \Omega) \int_{\Omega} |e(\Bu)|^p dx
    $$
    The constant $c$ is invariant under uniform scalings of the domain.
\end{theorem}

\begin{remark}
    In fact, the Theorem is valid for generalized functions of special bounded deformations, $GSBD^p$, however, to not introduce more complexity to this work we will just consider the case of $SBD^p$ functions, that is, functions in $SBD$ such that $e(\Bu)\in L^p(\Omega)$.
\end{remark}

\section{Korn inequality in plates for Sobolev functions, revisited}
\label{sec:kornPlateSob}

Having established the Korn inequality for functions in cubes, we can hope that extending the result for plates would follow the same steps as in the case of Sobolev functions, however is not that simple. The traditional proof of Korn's inequality with the desirable asymptotics in a plate \cite{bib:Fri.Jam.Mue.1, bib:Fri.Jam.Mue.2,conti0} normally follows the following steps (Very similar to what we did for the weighted Korn inequality \ref{sec:plateWKorn}):
\begin{enumerate}
    \item Split the plate in $N^2$ overlapping cubes of size $h^3$.
    \item Apply the Korn inequality  for bulk domains, \ref{KornGeneralDomain}, in each cube  to obtain skew-symmetric matrices $A_{i,j}$.
    \item Interpolate the matrices $A_{i,j}$ using a partition of unity to obtain a piecewise function $R_h$.
    \item Apply Poincaré inequality to $R_h$ to obtain constant matrix $R$.
    \item Choose the closest skew-symmetric matrix to $R$ to obtain the desired matrix $A$.
\end{enumerate}

Almost all the steps are valid for $SBD^p$ functions, except for the Poincaré inequality. Even if we are just applying the inequality in a piecewise linear function, as we can see from the Theorem \ref{KornBDGeneralDomain}, the inequality is not valid for the full domain, we need to exclude a set $\omega$ around the jump. While we can still apply the Poincaré Inequality in sets with small holes, there are no known bounds for the Poincaré constant, and it can be arbitrarily large. This was the main obstacle while extending the Korn inequality for $SBD^p$ functions in plates.

To overcome this problem we will start by giving an alternate proof of the Korn inequality for Sobolev functions in plates that do not need the Poincaré inequality but still give the desired asymptotics, $\CO(\frac{1}{h})$. After understanding better this new technique we will be able to prove the final result easily.

%TODO check dependency of C
\begin{theorem}[Korn's first inequality in plates for Sobolev functions] Let $D=[0,1]^2$ and $\Omega_h = D\times[-h,h]$ for some small $h$. Then for any   $\Bu\in W^{1,p}(\Omega_h:\R^3)$ there is  a skew-symmetric matrix $A$ such that
$$\|\nabla \Bu - A\|_{L^p(\Omega_h)}\leq \frac{C(p)}{h}\|e(\Bu)\|_{L^p(\Omega_h)}.$$
\end{theorem}
\begin{proof}
Since we are just interest on the asymptotics when $h\to 0$, we can assume, \textit{w.l.g.}, that $N=\frac{1}{h}\in\mathbb{N}$. 

\textit{Step 1:} The first step is to split $\Omega_h$ in overlapping cubes and apply the traditional Korn's first inequality in each cube. Consider the $(N-1)^2$ overlapping cubes of size $(2h)^3$:
$$D_{i,j}=\left[\frac{i-1}{N},\frac{i+1}{N}\right]\times\left[\frac{j-1}{N},\frac{j+1}{N}\right]\times[-h,h],\qquad i,j=1,\ldots,N-1,$$

and apply  Korn inequality (\ref{KornGeneralDomain}) to each cube to obtain obtain a skew-symmetric matrix $A_{i,j}$ such that 
    \begin{equation}\label{kornkjSobolev}
    \|\nabla \Bu- A_{i,j}\|_{L^p(D_{i,j})} \leq C_0(p) \|e(\Bu)\|_{L^p(D_{i,j})}
    \end{equation}
where $C_0$ is independent of the cube and $h$.

\textit{Step 2:} To be able to find the matrix that works in the full domain $\Omega_h$ we need to see how the matrices $A_{i,j}$ change between two intersecting cubes. Let  $D_{i,j}$ and $D_{i',j'}$ be 2 intersecting cubes and the respective matrices $A_{i,j}$ and $A_{i',j'}$, then
\begin{align*}
    (2h)^3|A_{i,j}-A_{i',j'}|^p & = \|A_{i,j}-A_{i',j'}\|^p_{L^p({D_{i,j}\cap D_{i',j'}})}\\
    &\leq 2^{p-1}\|\nabla \Bu-A_{i,j}\|^p_{L^p({D_{i,j}\cap D_{i',j'}})}p + \|\nabla \Bu-A_{i',j'}\|^p_{L^p({D_{i,j}\cap D_{i',j'}})}\\
    &\leq 2^{p-1}\|\nabla \Bu-A_{i,j}\|^p_{L^p(D_{i,j})}p + \|\nabla \Bu-A_{i',j'}\|^p_{L^p(D_{i',j'})}\\
    &\leq 2^{p-1}C_0 \left(\|e(\Bu)\|^p_{L^p(D_{i,j})}+\|e(\Bu)\|^p_{L^p(D_{i',j'})}\right).
\end{align*}
Additionally, since all $A$'s are constant and all the cubes have the same size, for any $(k,l)$ we have that
\begin{equation}\label{interCubes}
    \|A_{i,j}-A_{i',j'}\|^p_{L^p(D_{k,l})}\leq 2^p C_0 \left(\|e(\Bu)\|^p_{L^p(D_{i,j})}+\|e(\Bu)\|^p_{L^p(D_{i',j'})}\right).
\end{equation}

\textit{Step 3:} For non-intersecting cubes we need to create a path between them, in this step we will see how that works and how can it help.
First let's fix a matrix in the first collum, $j=1$, and fix some row $i$, then:
\begin{equation*}
    \|\nabla \Bu- A_{i,1}\|^p_{L^p(\Omega_h)} \leq \sum_{k=1}^{N-1}\sum_{l=1}^{N-1}\|\nabla \Bu- A_{i,1}\|^p_{L^p(D_{k,l})}.
\end{equation*}
    
To bound each term in the double sum, we need to consider a path between $D_{i,1}$ and $D_{k,l}$, so for $k\geq i$, we can consider a path of size less than $2N$ of the form
    $$D_{i,1}\to D_{i,2}\to\cdots\to D_{i,l}\to D_{i+1,l}\to\cdots\to D_{k,l},$$
as we can see in the figure \ref{fig:grid1}.

    \input{figures/grid1.tex}

For each term in the double sum, we can split it again through all the cubes in the path and apply inequality \ref{interCubes}: 
    \begin{align*}
    \|\nabla &u- A_{i,1}\|^p_{L^p(D_{k,l})} = \left\|\nabla \Bu+ \sum_{l'=2}^l (A_{i,l'}-A_{i, l'-1})+\sum_{k'=i+1}^k (A_{k',l}-A_{k'-1, l}) -A_{k,l}\right\|^p_{L^p(D_{k,l})}
    \\
    &\leq (2N)^{p-1}\bigg(\|\nabla \Bu-A_{k,l}\|^p_{L^p(D_{k,l})} + \sum_{l'=2}^l \|A_{i,l'}-A_{i, l'-1}\|^p_{L^p(D_{k,l})}\\
    &\qquad\qquad\qquad+\sum_{k'=i+1}^k \|A_{k',l}-A_{k'-1, l}\|^p_{L^p(D_{k,l})}\bigg)\\
    &\leq C_0(2N)^{p-1}\bigg(\|e(\Bu)\|^p_{L^p(D_{k,l})} + 2^p \sum_{l'=2}^l \big(\|e(\Bu)\|^p_{L^p(D_{i,l'})}+\|e(\Bu)\|^p_{L^p(D_{i,l'-1})}\big)\\
    &\qquad\qquad\qquad+2^p\sum_{k'=i+1}^k\big(\|e(\Bu)\|^p_{L^p(D_{k',l})}+\|e(\Bu)\|^p_{L^p(D_{k'-1,l})}\big|)\bigg)\\
    %&\leq c_0(p)(2N)^{p-1}(\int_{D_{k,l}}|e(\Bu)|^p dx + 2^{p+1} \sum_{l'=1}^l \int_{D_{i,l'}}|e(\Bu)|^p dx+2^{p+1}\sum_{k'=i}^k\int_{D_{k',l}}|e(\Bu)|^p dx)\\
    &\leq C_0 2^{2p+1}  N^{p-1}\left(\|e(\Bu)\|^p_{L^p(D_{i,-})}+\|e(\Bu)\|^p_{L^p(D_{-,l})}\right),
    \end{align*}
    
    where $D_{i,-}=\cup_{l=1}^{N-1} D_{i,l}$ is the row $i$ and $D_{-,l}=\cup_{i=1}^{N-1} D_{i,l}$ is the column $l$. 
    
    For $k<i$  a very similar argument holds and we get the same bound:
    $$\|\nabla \Bu- A_{i,1}\|^p_{L^p(D_{k,l})}\leq C_0 2^{2p+1}  N^{p-1} \left(\|e(\Bu)\|^p_{L^p(D_{i,-})}+\|e(\Bu)\|^p_{L^p(D_{-,l})}\right).$$
    
    Therefore, by summing  over all $k,l$ we obtain:
    \begin{align*}
        \sum_{k=1}^{N-1}\sum_{l=1}^{N-1}\|\nabla \Bu- A_{i,1}\|^p_{L^p(D_{k,l})}  & \leq C_0 2^{2p+1}N^{p-1}\sum_{k=1}^{N-1}\sum_{l=1}^{N-1}  \left(\|e(\Bu)\|^p_{L^p(D_{i,-})}+\|e(\Bu)\|^p_{L^p(D_{-,l})}\right)\\
        &\leq C_0 2^{2p+1}N^{p-1}\left( N^2 \|e(\Bu)\|^p_{L^p(D_{i,-})} +  2\sum_{k=1}^{N-1} \|e(\Bu)\|^p_{L^p(\Omega_h)}\right)\\
        &\leq C_0 2^{2p+1}N^{p-1}\left( N^2 \|e(\Bu)\|^p_{L^p(D_{i,-})} +  2N\|e(\Bu)\|^p_{L^p(\Omega_h)}\right).
    \end{align*}
    
    \textit{Step 4:} At first glance it looks like we finished the proof, however, we don't have the desired power of $N$. To get the desired power notice that we still have freedom over $i$. Summing over all $i$ we have that: 
    \begin{align*}
        \sum_{i=1}^{N-1} \|\nabla \Bu - A_{i,0}\|^p_{L^p(\Omega_h)}&\leq C_0 2^{2p+1}N^{p-1}\left( N^2  \sum_{i=1}^{N-1}\|e(\Bu)\|^p_{L^p(D_{i,-})} +  2N^2\|e(\Bu)\|^p_{L^p(\Omega_h)}\right)\\
        &\leq C_0(p) 2^{2p+3}N^{p+1}\|e(\Bu)\|^p_{L^p(\Omega_h)}.
    \end{align*}
    So in fact the power of $N$ doesn't change, but we are summing over $N-1$ elements, so there must exist some  $i'$  that will satisfy the inequality we are aiming at: 
    $$ \|\nabla \Bu - A_{i',0}\|^p_{L^p(\Omega_h)} \leq  C(p)N^{p}\|e(\Bu)\|^p_{L^p(\Omega_h)}=\frac{C(p)}{h^p}\|e(\Bu)\|^p_{L^p(\Omega_h)}.$$
\end{proof}

 \section[Korn inequality for plates in the space SBD]{Korn inequality for plates in the space $SBD$}
    \label{sec:kornPlateSBD}
    In this section, we will prove the main result of this chapter, the  Korn Inequality in plates for $SBD^p$ functions. More challenges will show up because not every path will be admissible due to the existence of jumps/cracks, however, the general idea will be very similar to the previous proof.

    \begin{theorem} Let $D=[-1,1]^2$ and $\Omega_h = D\times[-h,h]$ for some small $h$. Then for $\delta>0$ small enough, there exists $C = C(p)>0$, such that for any $\Bu\in SBD^p(\Omega_h)$ with $\CH^2(J_u)<\delta h$ there is a set $\omega\in\Omega_h$ with $\CL^3(\omega)\leq C \CH^2(J_u)$  and a skew-symmetric matrix $A$ such that
    $$\|\nabla \Bu-A\|^p_{L^p(\Omega_h \backslash \omega)} dx \leq \frac{C(p)}{h^p} \|e(\Bu)\|^p_{L^p(\Omega_h)}$$
    \end{theorem}
    \begin{proof}
    The beginning of the proof is exactly the same, we start by considering  $N = \frac{1}{h}\in \mathbb{N}$ and  apply  the Korn inequality \ref{KornBDGeneralDomain} at each overlapping cube:
    $$D_{i,j}=\left[\frac{i-1}{N},\frac{i+1}{N}\right]\times\left[\frac{j-1}{N},\frac{j+1}{N}\right]\times[-h,h],\qquad i,j=1,\ldots,N-1.$$
    to obtain the skew-symmetric matrixes $A_{i,j}$ and the sets of finite perimeter $\omega_{i,j}\subset D_{i,j}$ with $\CH^2(\partial^*\omega_{i,j})\leq C \CH^2(J_u\cap D_{i,j})$ such that
    \begin{equation}\label{kornkj}
    \|\nabla \Bu- A_{i,j}\|^p_{L^p(D_{i,j}\backslash \omega_{i,j})} \leq C_0(p) \|e(\Bu)\|^p_{L^p(D_{i,j})}.
    \end{equation}

    However, when working with plates, bounding the perimeter is not sufficient. So using the size of each cube we can also bound the volume of each $\omega_{i,j}$. Applying the isoperimetric inequality, we get that:
    $$\CL(\omega_{i,j})=(\CL(\omega_{i,j}))^{2/3}(\CL(\omega_{i,j}))^{1/3}\leq 2Ch \CH^2(\partial^*\omega_{i,j})\leq 2C_ph\CH^2(J_u\cap D_{i,j}).$$


    \textit{Step 2:}
    Here is when things start getting a bit different, because of $\omega_{i,j}$, we can't always control the difference between $A_{i,j}$ and $A_{i',j'}$ for two intersecting cubes $D_{i,j}$ and $D_{i',j'}$. In fact, to do that, we also need to control the size of $\omega_{i,j}$ and $\omega_{i',j'}$, so let's label  the cubes according to the portion of the jump that lands on them, i.e, let  $D_{k,j}$ be a good cube if 
    $$\CH^2(J_u\cap D_{k,j})\leq \frac{1}{4C_pC_0} h^2, \ \CL(\omega_{k,j})\leq h^3,$$
    and a bad cube otherwise, we can define
    $$G_{idx}=\{(k,j): D_{k,j}\text{ is a good cube}\},$$ 
    $$B_{idx}=\{(k,j): D_{k,j}\text{ is a bad cube}\}.$$
    Now for this definition to be useful we need to make sure that we have enough good cubes to represent the plate, but since we control the size of  the jump and since every point in $\Omega_h$ can be at  most at $4$ cubes, then
    \begin{align*}
        \CH^2(J_u)&= \CH^2\left(\bigcup_{i,j}\left(J_u\cap D_{i,j}\right)\right)\\
        &\geq \frac{1}{4}\sum_{k,j}\CH^2(J_u\cap D_{i,j})\\
        &\geq Ch^2\CH^0(B_{idx}).
    \end{align*}
    and consequently, we  can bound the number of bad cubes two in different ways:
    \begin{align}\label{badCubeBound}
        \CH^0(B_{idx})&\leq\frac{C\CH^2(J_u)}{h^2},\\
        \CH^0(B_{idx})&\leq C \delta N.
    \end{align}

    \textit{Step 3:} Consider 2 intersecting good cubes, $D_{i,j},D_{i',j'}$, then we can actually bound  the  difference of $A_{i,j}$ and $A_{i',j'}$. First notice that by the definition of a good cube, we can find a lower bound of the good part of their intersection, \textit{i.e.}, $\CL((D_{i,j}\cap D_{i',j'})\backslash(\omega_{i,j}\cup\omega_{i',j'}))\geq 2h^3$ and  then we can repeat the same argument as before
    \begin{align*}
        (2h)^3|A_{i,j}-A_{i',j'}|^p &\leq\|A_{i,j}-A_{i',j'}\|^p_{L^p((D_{i,j}\cap D_{i',j'})\backslash(\omega_{i,j}\cup\omega_{i',j'}))}\\
        &\leq 2^{p-1}\left(\|\nabla \Bu-A_{i,j}\|^p_{L^p(D_{i,j}\backslash \omega_{i,j})}+\|\nabla \Bu-A_{i',j'}\|^p_{L^p(D_{i',j'}\backslash \omega_{i',j'})}\right)\\
        &\leq C(p)\left(\|e(\Bu)\|^p_{L^p(D_{i,j})}+\|e(\Bu)\|^p_{L^p(D_{i',j'})}\right).
    \end{align*}
    Furthermore, for any target good cube, $D_{i'',j''}$, that we will need to integrate over, we also have that
    \begin{align*}
    \|A_{k,j}-A_{k',j'}\|^p_{L^p(D_{i'',j''}\backslash \omega_{i'',j''})} & \leq 8h^3 |A_{k,j}-A_{k',j'}|^p\\
    &\leq C \left(\|e(\Bu)\|^p_{L^p(D_{i,j}\backslash \omega_{i,j})} +\|e(\Bu)\|^p_{L^p(D_{i',j'}\backslash \omega_{i',j'})} d x\right).
    \end{align*}
    
    \textit{Step 4:} In this next step  we will  define the set $\omega$. At least we know that it has to contain all $\omega_{i,j}$, but from the previous step. it would also make sense to add all the bad cubes. Maybe that would be enough, but to simplify the proof we will consider a bigger $\omega$ that is still small enough.
    
    Let $D_{i,-}=\cup_{j'} D_{i,j'},\  D_{-,j}={\cup_{i'}D_{i',j}}$ be the row $i$ and column $j$ respectively. We say that $D_{i,-}$ is a good row if $D_{i,j'}$ is a good cube for all $j'$ and a bad row otherwise, and similarly for $D_{-,j}$. To simplify the notation let's define:
    $$B^r_{idx}=\{i: D_{i,-}\text{ is a bad row}\}, \qquad \CH^0(B^r_{idx})\leq \CH^0(B_{idx}), $$
    $$B^c_{idx}=\{j: D_{-,j}\text{ is a bad column}\},\qquad \CH^0(B^c_{idx})\leq \CH^0(B_{idx}).  $$
    
    To make it easy to construct paths between good cubes,  we can exclude all the cubes that belong to both a bad row and a bad collum, \textit{i.e.} (check  figure \ref{fig:grid2} for a better understanding):
    $$\omega = \left(\bigcup_{i\in B^r_{idx},j\in B^c_{idx}}D_{i,j}\right)\bigcup \left(\bigcup_{i,j} \omega_{i,j}\right).$$
    
    To bound the size of $\omega$ we will use the fact that we can't have that many bad rows and columns, so
    \begin{align*}
        \CL(\omega)&\leq (2h)^3\CH^0(B^r_{idx})\CH^0(B^c_{idx})+ \sum_{(i,j)\notin B_{idx}} \CL(\omega_{i,j})\\
        &\leq \delta 2^6 C^2 c^2\CH(J_u)^2 + 8Cch\CH^2(J_u)\\
        &\leq C \delta \CH^2(J_u).
    \end{align*}
   
    
    \textit{Step 5:} Now that we finally define all the good cubes, we need to find paths of $\CO(N)$  cubes to connect them. For the rest of the proof to follow as before we need to make sure that the path only passes through good cubes and additionally, no more than $\mathcal{O}(N)$ paths can pass in the same cube outside row $i$.

    For this let's start by considering  the sequences containing the indexes of the good and bad columns, $g_l$ and $b_l$, respectively:
    $$g_l = l\text{-th smallest index not in }  B^c_{idx}\qquad l=1,\cdots G=(N-1)-\CH^0(B^c_{idx}),$$
    $$b_l = l\text{-th smallest index in }  B^c_{idx}\qquad l=1,\cdots B=(N-1)-\CH^0(B^c_{idx}).$$
    
    Consider $j= 1$ and fix $i\notin B^r_{idx}$, so
    \begin{align}\label{eq:step4}
    \int_{\Omega\backslash\omega }\|\nabla \Bu- A_{i,1}\|^p_{L^p(\Omega_h\backslash \omega)} \leq \sum_{l=1}^G\sum_{k=0}^{N-1}&\|\nabla \Bu- A_{i,1}\|^p_{L^p(D_{k,g_l}\backslash \omega_{h,g_l})}\\&+\sum_{l=1}^B\sum_{k\notin B^r_{idx}}\|\nabla \Bu- A_{i,j_1}\|^p_{L^p(D_{k,b_l}\backslash \omega_{k,b_l})}.
    \end{align}
    
    \textit{W.l.o.g.} we can consider $k\geq i$ and approach the two terms on the right-hand side separately. For the first term, the target cube, $D_{k,g_l}$,  is in a good column, and for the second the target cube will not be in a good column but it will be in a good row, so as we can see in the figure \ref{fig:grid2} there are two different types of paths we can use.
    \input{figures/grid2.tex}
    For the first case(\ref{fig:grid2}a)) the path is simillar to the previous proof:
        $$D_{i,1}\to D_{i,2}\to\cdots\to D_{i,g_l}\to D_{i+1,g_l}\to\cdots\to D_{k,g_l}.$$
    So as in the case of $\CL^p$ functions,  we have that 

    $$\|\nabla \Bu- A_{i,1}\|^p_{L^p(D_{k,g_l}\backslash \omega_{k,g_l})}\leq C N^{p-1}\left(\int_{D_{i,-}}\|e(\Bu)\|^p_{L^p(D_{i,-})}+\|e(\Bu)\|^p_{L^p(D_{-,g_l})}\right).$$
    
    However, for the second term,  we need to find a path that goes around the islands created by $\omega$, but we need to be careful to not have too many paths passing in the same column. For  $\delta$ small enough, there will be fewer bad columns than good ones so we can consider the following path represented in the figure \ref{fig:grid2}b):
    $$D_{i,1}\to\cdots\to D_{i,g_l}\to\cdots\to D_{k,g_l}\to\cdots\to D_{k,b_l}.$$
    
    And repeating the same steps as in the Sobolev case we get:
    
    $$\|\nabla \Bu- A_{i,1}\|^p_{L^p(D_{k,b_l}\backslash \omega_{k,b_l})}\leq C N^{p-1}\left(\|e(\Bu)\|^p_{L^p(D_{i,-})}+\|e(\Bu)\|^p_{L^p(D_{k,-})}+\|e(\Bu)\|^p_{L^p(D_{-,g_l})}\right).$$
    
    So substituting in both terms of \ref{eq:step4} we get:

    
    \begin{align*}
    \sum_{l=1}^G\sum_{k=0}^{N-1}\|\nabla  \Bu- A_{i,1}\|^p_{L^p(D_{k,g_l}\backslash \omega_{k,g_l})} &\leq CN^{p-1}\sum_{l=1}^G\sum_{k=0}^{N-1}  \left(\|e(\Bu)\|^p_{L^p(D_{i,-})}+\|e(\Bu)\|^p_{L^p(D_{-,g_l})}\right)\\
        &\leq C N^{p-1}\left( N^2\|e(\Bu)\|^p_{L^p(D_{i,-})}+ 2\sum_{k=1}^{N-1} \|e(\Bu)\|^p_{L^p(\Omega_h)} \right) \\
        &= CN^{p+1} \|e(\Bu)\|^p_{L^p(D_{i,-})} + C N^p \|e(\Bu)\|^p_{L^p(\Omega_h)} ,
    \end{align*}
    \begin{align*}
    \sum_{l=1}^B\sum_{k\notin b^r_{idx}}&\|\nabla \Bu- A_{i,1}\|^p_{L^p(D_{k,b_l}\backslash \omega_{k,b_l})}   \\ &\leq C N^{p-1} \sum_{l=1}^B\sum_{k\notin b^r_{idx}}\left(\|e(\Bu)\|^p_{L^p(D_{i,-})}+\|e(\Bu)\|^p_{L^p(D_{k,-})}+\|e(\Bu)\|^p_{L^p(D_{-,b_l})}\right)\\
        &\leq CN^{p-1} \left(N^2\|e(\Bu)\|^p_{L^p(D_{i,-})} + 2\sum_{l=1}^B \|e(\Bu)\|^p_{L^p(\Omega_h)} + 2\sum_{k\notin b^r_{idx}} \|e(\Bu)\|^p_{L^p(\Omega_h)} \right) \\
        &\leq CN^{p+1}\|e(\Bu)\|^p_{L^p(D_{i,-})} +C N^p \|e(\Bu)\|^p_{L^p(\Omega_h)}. 
    \end{align*}
    
    \textit{Step 6:} Now we can conclude the proof by summing over all $i\notin B^r_{idx}$  to get the desired asymptotics.
    \begin{align*}
        \sum_{i\notin B^r_{idx}} \|\nabla \Bu - A_{i,0}\|^p_{L^p(\Omega_h\backslash\omega)}&\leq C N^{p+1}\sum_{i\notin B^r_{idx}}  \|e(\Bu)\|^p_{L^p(D_{i,-})}+ C N^p\sum_{i\notin B^r_{idx}}\|e(\Bu)\|^p_{L^p(\Omega_h)}\\
        &\leq CN^{p+1}\|e(\Bu)\|^p_{L^p(\Omega_h)},
    \end{align*}
    and since  we are summing over at least $N/2$ elements, there must exist $i'$ such that
    $$ \|\nabla \Bu - A_{i',0}\|^p_{L^p(\Omega_h\backslash\omega)}\leq  C(p)N^{p}\|e(\Bu)\|^p_{L^p(\Omega_h)}=\frac{C(p)}{h^p}\|e(\Bu)\|^p_{L^p(\Omega_h)},$$
    as desired.
    
    \end{proof}
    